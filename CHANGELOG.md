# История изменений


## Не выпущено в релиз
TO-DO: 
- полноценный разбор адреса на составляющие и маппинг результата на адрес формата ОСМ
- переделка алгоритма поиска дублей на валидатор (реализовано частично)
- использование списка ответов ЕГРН не только для валидации, но и для кэширования запросов
- вынос приоритета ошибок валидации в настройки
- режим валидации уже существующих в ОСМ данных (без перезаписи, но со списком ошибок)
- отдельная настройка разрешения окна запроса для массового запроса
- корректный расчёт точки запроса для здания-мультиполигона сложной формы

## Добавлено
### 0.9.5.1
- настройки слов-исключений, которые блокируют присвоение адреса
- новый валидатор конфликтов данных 
### 0.9.5
- настройки распознавания типов зданий через меню
- настройки фильтров зданий при массовом запросе через меню
- присвоение расширенной информации из ЕГРН при массовом запросе
- выгрузка информации об обработанных адресах в файл формата CSV 
### 0.9.4.8
- тонкие настройки запроса к АПИ - размер запрашиваемой области и разрешение запроса
- новые типы зданий - детсад, гараж, часовня
### 0.9.4
- работа с новым АПИ ЕГРН, смигрированного в НСПД
- настройки запрашиваемых слоев данных отдельно для инструментов запроса по клику и массового запроса
- расширенная информация из ЕГРН всегда добавляется к тэгам точки при запросе по клику
- новое действие - добавление WMS слоев НСПД в настройки JOSM по клику в меню
- возможность импортировать из ПКК слоев НСПД геометрии зданий, с присвоением адреса и тэгов здания (тип, этажность)
- функция автоупрощения импортированной геометрии
- функция фильтрации импортированной геометрии по минимальной площади
- возможность смержить данные из разных источников на одной точке запроса по клику
### 0.9.3
- новая функциональность точечного запроса - запрос дополнительных данных из ЕГРН. Описание см. [README.md](https://github.com/micronull/JOSM-Russia-address-helper-plugin/blob/master/README.md#запрос-дополнительных-данных)
- исправление артефактов ЕГРН - замена строк вида "кв. квартира" на "кв" во входных данных
- костыльный алгоритм инвалидации плохо распознанного адреса, когда нумерованная улица или место пересекаются с номером дома
### 0.9.1
- заменяем в адресе из ЕГРН подстроку " ." на ". " (борьба с опечатками)
### 0.9.0.1
- заведен файл истории изменений
- настройка отключения SSL
- функционал разбора и присвоения адресов по "не-уличным" обьектам - микрорайон, квартал, деревня, посёлок, село
- (БОЛЬШОЕ) теперь все ошибки и проблемы разбора обрабатываются валидаторами JOSM, там же и механизмы их исправления
- автоудаление отладочных тэгов ("addr:RU:egrn", "addr:RU:egrn_type", "addr:RU:extracted_name", "addr:RU:extracted_type", "addr:RU:parsed_housenumber",
  "addr:RU:parsed_flats", "egrn_name") и точек "плохих" адресов (fixme = REMOVE_ME!) при загрузке данных в ОСМ
- сопоставление с обьектами ОСМ по расстоянию, настраиваемому в конфигурации, чтобы исключить ложное срабатывание
- сопоставление с полигонами и мультиполигонами НП, генерация ошибок если адрес вне полигона/мультиполигона
- конфигурируемое ограничение на количество одновременно запрашиваемых зданий
- автодетект и предупреждение при бане со стороны Росреестра
- обязательность подключения сдвигового слоя ПКК (масса ошибок в обработанных плагином данных, там где юзер не настроил смещение)
- предупреждение если у сдвигового слоя не настраивался собственно сдвиг (равен 0)
- добавлен тип улицы "бульвар"
- проверка на внесение дубликатов в диалогах исправления ошибок "Валидатор нечеткого совпадения места/улицы", "Валидатор совпадения по инициалам". Теперь дублирующийся адрес не будет присвоен, а здание будет обработано валидатором дубликатов
- подсветка дублирующегося с ОСМ адреса в валидаторе "Множественный валидный адрес"
 
## Изменено
### 0.9.4.8
- все валидаторы теперь могут работать с мультиполигонами
### 0.9.4
- удалена настройка "Запрашивать расширенные данные из ПКК", поскольку в новом АПИ доп. данные возвращаются всегда
- улучшена обработка ошибок при запросе по клику, сетевые и программные ошибки должны теперь отображаться во всплывающих оповещениях
### 0.9.3
- добавлен тэг для квартала place = quarter
### 0.9.2
- добавлен тип НП "хутор"
- добавлен тип улицы "аллея"
### 0.9.1
- изменена нумерация версий плагина на более общепринятую
- адрес не присваивается, если есть второй, для которого разобрана улица, но не найдена в ОСМ
- не обрабатываются building = roof, shack
### 0.9.0.1
- переписан README.md с целью облегчить понимание и использование плагина
- убрана генерация адресных точек для нераспознанных и дополнительных адресов в режиме массовой загрузки
- убрана настройка "Создавать адресные точки для нераспознанных адресов", в режиме пипетки такие точки создаются всегда, в режиме массовой загрузки - никогда
 
## Исправлено
### 0.9.6.1
- зависание при попытке запросить здания, собранные из мультиполигонов
- неверно рассчитывалась точка запроса при запросе здания сложной формы
- всегда удаляем примитивы из кэша валидации при удалении (срабатывание валидаторов на уже удаленные обьекты) 
### 0.9.4.8
- исправлены нефатальные баги в валидаторах дубликатов, валидаторе нераспознанной улицы, множественного адреса. 
### 0.9.4
- исправлено неверное распознавание "ш" на конце слова как признак типа шоссе
### 0.9.3
- запатчен странный вылет в валидаторе дубликатов
- исправлена ошибка матчинга "квартал" в "аллею"
### 0.9.2
- исправлена ошибка в алгоритме определения, когда не присваивать адрес
- исправлена ошибка в распознавании номера дома, когда номер квартиры присваивался как номер корпуса
### 0.9.1
- исправлен вылет в исправлении ошибки дублирующихся адресов
- добавлены варианты префикса номера корпуса "кор." и "к."
- исправлена ошибка в валидаторе совпадения улицы по инициалам, при исправлении использовалось неверное имя улицы
- фильтрация тэгов при выгрузке в ОСМ: "addr:RU:extracted_street_name", "addr:RU:extracted_street_type", "addr:RU:extracted_place_name", "addr:RU:extracted_place_type"
### 0.9.0.1
- корректно распознается сокращение "пр-кт"
- теперь корректно распознаются улицы, содержащие "ул" в названии
- номер дома не может быть больше 999
- длина буквенной части номера ограничена 3 символами (чтобы "9 января" не лезло в номер дома)
- диалог прогресса загрузки стал более информативным
- исправлен вылет если при запросе адреса под курсором не получен валидный адрес и отключена опция "Создавать адресные точки для нераспознанных адресов"
- распознавание некоторых адресов и номеров домов
- распознавание двойных типов улицы (адреса вида "улица 1-й Механический проезд", "улица Сиреневый бульвар")
- сопоставление улиц содержащих заглавную Ё
- удалены устаревшие настройки
- обработка ситуации "нумерованная улица/место распозналась как номер дома"