# rules - правила для сопоставления обьектов osm для заполнения тега addr:place
# patterns - соответствия адреса из ЕГРН данному типу
#

types:
  - name: квартал
    osm:
      patterns:
        - '^(?:квартал\S*\s+)?(?<place>.+?)(?:\s+квартал\S*)?$' # квартал Строителей, Зелёный квартал, Зеленый-2, 1-ый Строителей
    tags:
      place:
        - neighbourhood
    egrn:
      patterns:
        - '((?<placeNumber>\d{1,2}(\s|-)(й|ий|ый|ой|я|ая|ья|е|ое|ье)\s)?(?:(к-л(?:\.|\s))|квартал|(кв-л(?:\.|\s)))\s*)(?:им\.?\s)?(?<place>[0-9A-Я"]+[а-яA-Я0-9-"\.]*(?:\s(?:[а-яA-Я0-9-"\.])+)*)'
        - '((?<placeNumber>\d{1,2}(\s|-)(й|ий|ый|ой|я|ая|ья|е|ое|ье)\s)?(?<place>[0-9A-Я"]+[а-яA-Я0-9-"\.]*(?:\s(?:[а-яA-Я0-9-"\.])+)*)(\s{1,2})(?:(к-л(?:\.|\s))|квартал|кв-л(\.)?)\s*)'
  - name: микрорайон
    osm:
      patterns:
        - '^(?:микрорайон\s?)?(?<place>.+?)(?:\s?микрорайон)?$' # микрорайон Трактористов, Переходный микрорайон
    tags:
      place:
        - neighbourhood
        - suburb
    egrn:
      patterns:
        - '((?<placeNumber>\d{1,2}(\s|-)(й|ий|ый|ой|я|ая|ья|е|ое|ье)\s)?(?:(мкр(?:\.|\s))|микрорайон|(мк(?:\.|\s)))\s*)(?:им\.?\s)?(?<place>[0-9A-Я"]+[а-яA-Я0-9-"\.]*(?:\s(?:[а-яA-Я0-9-"\.])+)*)' # Калужская область, р-н Дзержинский, п. Товарково, мк. Звездный-2, д. №20
        - '((?<placeNumber>\d{1,2}(\s|-)(й|ий|ый|ой|я|ая|ья|е|ое|ье)\s)?(?<place>[0-9A-Я"]+[а-яA-Я0-9-"\.]*(?:\s(?:[а-яA-Я0-9-"\.])+)*)(\s{1,2})(?:(мкр(?:\.|\s))|микрорайон)\s*)' #Калужская область, р-н Дзержинский, п. Товарково, Звездный микрорайон, д. №20
#  - name: город
#   # osm:
#      patterns:
#        - '(?<place>[А-Я][а-я]+((\s|-)[А-Я]?[а-я]*)*)' #берем все, фильтрация по тэгам
#    tags:
#      place:
#        - city
#        - town
#    egrn:
#      patterns:
#       #отключил город - у города должны быть улицы! адрес вида "Свердловская область, г. Полевской, п. Зеленый Лог, 12А" берет в себя город
#        - '((,|\s){1,2}(?<placeNumber>\d{1,2}(\s|-)(й|ий|ый|ой|я|ая|ья|е|ое|ье)\s)?(?:(г(?:\.|\s))|город)\s*)(?:им\.?\s)?(?<place>[0-9A-Я"]+[а-яA-Я0-9-"\.]*(?:\s(?:[а-яA-Я0-9-"\.])+)*)' # Свердловская обл., г. Екатеринбург, пер. Переходный, 7
#        - '((,|\s){1,2}(?<placeNumber>\d{1,2}(\s|-)(й|ий|ый|ой|я|ая|ья|е|ое|ье)\s)?(?:(п(?:\.|\s))|поселок|(пос(?:\.|\s)))\s*)(?:им\.?\s)?(?<place>[0-9A-Я"]+[а-яA-Я0-9-"\.]*(?:\s(?:[а-яA-Я0-9-"\.])+)*)' #"Калужская обл., р-н Думиничский, п. Думиничи, 1-й Ленинский пер., д. 21"
  - name: деревня
    osm:
      patterns:
        - '(?<place>[А-Я][а-я.]+((\s|-)[А-Я]?[а-я]*)*)'
    tags:
      place:
        - village
        - hamlet
    egrn:
      patterns:
        # в такой форме регулярка цепляет номера домов ("д. 15"). Отключено.
        #- '((?<placeNumber>\d{1,2}(\s|-)(й|ий|ый|ой|я|ая|ья|е|ое|ье)\s)?(?:(д(?:\.|\s))|(дер(?:\.|\s))|деревня)\s*)(?:им\.?\s)?(?<place>[0-9A-Я"]+[а-яA-Я0-9-"\.]*(?:\s(?:[а-яA-Я0-9-"\.])+)*)'
        - '((,|\s){1,2}(?<placeNumber>\d{1,2}(\s|-)(й|ий|ый|ой|я|ая|ья|е|ое|ье)\s)?(?:(д(?:\.|\s))|(дер(?:\.|\s))|деревня)\s*)(?:им\.?\s)?(?<place>[A-Я"]+[а-яA-Я-"\.]*(?:\s(?:[а-яA-Я-"\.])+)*)'
  - name: село
    osm:
      patterns:
        - '(?<place>[А-Я][а-я.]+((\s|-)[А-Я]?[а-я]*)*)'
    tags:
      place:
        - village
        - hamlet
    egrn:
      patterns:
        - '((,|\s){1,2}(?<placeNumber>\d{1,2}(\s|-)(й|ий|ый|ой|я|ая|ья|е|ое|ье)\s)?(?:(с(?:\.|\s))|село)\s*)(?:им\.?\s)?(?<place>[0-9A-Я"]+[а-яA-Я0-9-"\.]*(?:\s(?:[а-яA-Я0-9-"\.])+)*)'
  - name: посёлок
    osm:
      patterns:
        - '(?:пос(ё|е)лок\s)?(?<place>[А-Я][а-я.]+((\s|-)[А-Я]?[а-я]*)*)(?:\sпос(ё|е)лок)?'
    tags:
      place:
        - village
        - hamlet
    egrn:
      patterns:
        - '((,|\s){1,2}(?<placeNumber>\d{1,2}(\s|-)(й|ий|ый|ой|я|ая|ья|е|ое|ье)\s)?(?:(п(?:\.|\s))|поселок|(пос(?:\.|\s)))\s*)(?:им\.?\s)?(?<place>[0-9A-Я"]+[а-яA-Я0-9-"\.]*(?:\s(?:[а-яA-Я0-9-"\.])+)*)' #"Калужская обл., р-н Думиничский, п. Думиничи, 1-й Ленинский пер., д. 21"